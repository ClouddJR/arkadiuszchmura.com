<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>How to setup comments on your static blog | Arkadiusz Chmura</title>
<meta name=keywords content><meta name=description content="With a tool called utterances, it&rsquo;s very easy to add comments to your website with minimal code and no need for a database."><meta name=author content><link rel=canonical href=https://arkadiuszchmura.com/posts/how-to-setup-comments-on-your-static-blog/><link crossorigin=anonymous href=/assets/css/stylesheet.min.2a98b1550cccc65faf3cf4916bdbf4af464fffd9915ac511833ff1fe2426ad22.css integrity="sha256-KpixVQzMxl+vPPSRa9v0r0ZP/9mRWsURgz/x/iQmrSI=" rel="preload stylesheet" as=style><link rel=icon href=https://arkadiuszchmura.com/favicon.ico><link rel=apple-touch-icon href=https://arkadiuszchmura.com/apple-touch-icon.png><script async src="https://www.googletagmanager.com/gtag/js?id=G-9BS720SLJB"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-9BS720SLJB",{anonymize_ip:!1})}</script><meta name=twitter:title content="How to setup comments on your static blog | Arkadiusz Chmura"><meta name=twitter:description content="With a tool called utterances, it&rsquo;s very easy to add comments to your website with minimal code and no need for a database."><meta property="og:title" content="How to setup comments on your static blog | Arkadiusz Chmura"><meta property="og:description" content="With a tool called utterances, it&rsquo;s very easy to add comments to your website with minimal code and no need for a database."><meta property="og:type" content="article"><meta property="og:url" content="https://arkadiuszchmura.com/posts/how-to-setup-comments-on-your-static-blog/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-05-30T00:00:00+00:00"><meta property="article:modified_time" content="2023-05-30T00:00:00+00:00"><meta property="og:site_name" content="Arkadiusz Chmura"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://arkadiuszchmura.com/posts/"},{"@type":"ListItem","position":2,"name":"How to setup comments on your static blog","item":"https://arkadiuszchmura.com/posts/how-to-setup-comments-on-your-static-blog/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"How to setup comments on your static blog | Arkadiusz Chmura","name":"How to setup comments on your static blog","description":"With a tool called utterances, it\u0026rsquo;s very easy to add comments to your website with minimal code and no need for a database.","keywords":[],"wordCount":"797","inLanguage":"en","datePublished":"2023-05-30T00:00:00Z","dateModified":"2023-05-30T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://arkadiuszchmura.com/posts/how-to-setup-comments-on-your-static-blog/"},"publisher":{"@type":"Organization","name":"Arkadiusz Chmura","logo":{"@type":"ImageObject","url":"https://arkadiuszchmura.com/favicon.ico"}}}</script><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&display=swap" rel=stylesheet><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript></head><body class="type-posts kind-page layout-" id=top><script data-no-instant>function switchTheme(e){switch(e){case"light":document.body.classList.remove("dark");break;case"dark":document.body.classList.add("dark");break;default:window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")}}function isDarkTheme(){return document.body.className.includes("dark")}function getPrefTheme(){return localStorage.getItem("pref-theme")}function setPrefTheme(e){switchTheme(e),localStorage.setItem("pref-theme",e)}const toggleThemeCallbacks={};toggleThemeCallbacks.main=e=>{setPrefTheme(e?"light":"dark")},window.addEventListener("toggle-theme",function(){const e=isDarkTheme();for(const t in toggleThemeCallbacks)toggleThemeCallbacks[t](e)});function toggleThemeListener(){window.dispatchEvent(new CustomEvent("toggle-theme"))}</script><script>(function(){const t="light",e=getPrefTheme(),n=e||t;switchTheme(n)})()</script><header class=header><nav class=nav><div class=logo><a href=https://arkadiuszchmura.com/ accesskey=h title="Arkadiusz Chmura (Alt + H)">Arkadiusz Chmura</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://arkadiuszchmura.com/archive/ title=Archive>Archive</a></li><li><a href=https://arkadiuszchmura.com/search/ title="Search (Alt + /)" data-no-instant accesskey=/>Search</a></li></ul></nav></header><main class="main post"><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://arkadiuszchmura.com/>Home</a>&nbsp;»&nbsp;<a href=https://arkadiuszchmura.com/posts/>Posts</a></div><h1 class=post-title>How to setup comments on your static blog</h1><div class=post-meta><span class=meta-item><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar" style="user-select:text"><rect x="3" y="4" width="18" height="18" rx="2" ry="2" style="user-select:text"/><line x1="16" y1="2" x2="16" y2="6" style="user-select:text"/><line x1="8" y1="2" x2="8" y2="6" style="user-select:text"/><line x1="3" y1="10" x2="21" y2="10" style="user-select:text"/></svg><span>May 30, 2023</span></span><span class=meta-item>
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke="currentcolor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><span>4 min</span></span></div></header><div class=post-content><h2 id=introduction>Introduction<a hidden class=anchor aria-hidden=true href=#introduction>¶</a></h2><p>In this post, I&rsquo;ll show you how to setup comments on your static blog with a tool called <a href=https://utteranc.es/>utterances</a>. It&rsquo;s a lightweight, free, and open-source comments widget built on GitHub issues.</p><p>You can see what this tool looks like by scrolling to the bottom of the page where the comments section is.</p><p>The idea is simple. Every post on your blog will have a dedicated issue on your chosen GitHub repository. Then, every comment on your post will essentially become a comment on that issue. As a result, you won&rsquo;t need dedicated storage for these comments. Everything will be stored in your repository.</p><p>The only downside is that this way of adding comments requires users to have a GitHub account. If you have a technical blog or a website, that shouldn&rsquo;t be a problem since the majority of your audience is familiar with this tool. However, if that&rsquo;s not the case, you might want to look for something simpler.</p><p>My blog is built with <a href=https://gohugo.io/>Hugo</a> and a theme called <a href=https://github.com/reorx/hugo-PaperModX>PaperModX</a>, and that&rsquo;s what I&rsquo;ll be showing here. However, given how easy the integration is, you shouldn&rsquo;t have any problems with it when using different tools.</p><h2 id=integration>Integration<a hidden class=anchor aria-hidden=true href=#integration>¶</a></h2><p>Integration with utterances is relatively simple. You have to go to <a href=https://utteranc.es/>their website</a> and follow a couple of steps mentioned in the configuration section.</p><p>First, you choose a repository where you want to store your comments (and add the utterances app to it). Next, you select some options, like how you want to map your posts to issue titles or which theme you want to use on the widget. Lastly, you are given a code snippet containing a script tag that you have to add to your blog&rsquo;s template and position it where you want your comments to appear.</p><p>In the case of my blog, I had to add <code>comments: true</code> to my <code>config.yaml</code> file and then create the <code>layouts/partials/comments.html</code> file containing the generated script tag:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;https://utteranc.es/client.js&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>repo</span><span class=o>=</span><span class=s>&#34;ClouddJR/arkadiuszchmura.com&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>issue-term</span><span class=o>=</span><span class=s>&#34;pathname&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>label</span><span class=o>=</span><span class=s>&#34;comments&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>theme</span><span class=o>=</span><span class=s>&#34;github-light&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>crossorigin</span><span class=o>=</span><span class=s>&#34;anonymous&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>async</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></div><blockquote><p>Notice how the options you selected in the configuration step match the attributes on the script tag.</p></blockquote><h3 id=dark-mode>Dark mode<a hidden class=anchor aria-hidden=true href=#dark-mode>¶</a></h3><p>That&rsquo;s pretty much it when it comes to the integration. If you&rsquo;ve configured everything correctly, you should have a working system for adding comments to your website.</p><p>However, you might have noticed that my blog supports a dark mode that you can toggle by clicking on the icon at the top of the page. With the current configuration in the script tag, the theme used by the utterances widget will always be <code>github-light</code>, even when using dark mode on the website.</p><p>This definitely doesn&rsquo;t provide the best user experience, so I decided to find a way to set the correct initial theme when loading the page and also change the theme every time the user toggles it on the website.</p><p>This is the code that I ultimately used (I placed it right below the script tag for the utterances widget):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nx>updateUtterancesTheme</span><span class=p>(</span><span class=nx>isLight</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>iframe</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s1>&#39;.utterances-frame&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>iframe</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kr>const</span> <span class=nx>message</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>type</span><span class=o>:</span> <span class=s1>&#39;set-theme&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>theme</span><span class=o>:</span> <span class=nx>isLight</span> <span class=o>?</span> <span class=s1>&#39;github-light&#39;</span> <span class=o>:</span> <span class=s1>&#39;github-dark&#39;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=nx>iframe</span><span class=p>.</span><span class=nx>contentWindow</span><span class=p>.</span><span class=nx>postMessage</span><span class=p>(</span><span class=nx>message</span><span class=p>,</span> <span class=s1>&#39;https://utteranc.es&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>The above is the function (credit goes to <a href=https://github.com/utterance/utterances/issues/549#issuecomment-907606127>this person</a>) for updating the theme used by the utterances widget. If the passed <code>isLight</code> variable is true, we&rsquo;ll use the <code>github-light</code> theme. Otherwise, it&rsquo;s going to be <code>github-dark</code>.</p><p>I wanted to execute this function as soon as the page loads and right before the utterances <code>iframe</code> makes a request. Here&rsquo;s one way of doing it:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Set correct initial utterance theme
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>handleMessageEvent</span><span class=p>(</span><span class=nx>event</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>event</span><span class=p>.</span><span class=nx>origin</span> <span class=o>!==</span> <span class=s1>&#39;https://utteranc.es&#39;</span><span class=p>)</span> <span class=k>return</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>isLight</span> <span class=o>=</span> <span class=o>!</span><span class=nb>document</span><span class=p>.</span><span class=nx>body</span><span class=p>.</span><span class=nx>classList</span><span class=p>.</span><span class=nx>contains</span><span class=p>(</span><span class=s1>&#39;dark&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>updateUtterancesTheme</span><span class=p>(</span><span class=nx>isLight</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>removeEventListener</span><span class=p>(</span><span class=s1>&#39;message&#39;</span><span class=p>,</span> <span class=nx>handleMessageEvent</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;message&#39;</span><span class=p>,</span> <span class=nx>handleMessageEvent</span><span class=p>)</span>
</span></span></code></pre></div><p>After these changes, the theme is set correctly after the page loads. The only thing left to do is to update the theme after toggling it using the icon at the top of the page.</p><p>Luckily, with PaperModX, it&rsquo;s quite easy to do. I just had to add the <code>updateUtterancesTheme</code> function to the array of callbacks that will be invoked every time the theme is changed, like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Update utterances theme every time the theme is changed by a user
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>toggleThemeCallbacks</span><span class=p>[</span><span class=s1>&#39;comments&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=nx>updateUtterancesTheme</span>
</span></span></code></pre></div><p>And that&rsquo;s all! If you want to get the whole picture and see all the changes in one place, <a href=https://github.com/ClouddJR/arkadiuszchmura.com/commit/191666a418713c4ae25fac9b2b1f6659429b84a4>here&rsquo;s the commit</a> on my blog&rsquo;s repository that introduced utterances. Also, feel free to explore the rest of the code.</p><h2 id=summary>Summary<a hidden class=anchor aria-hidden=true href=#summary>¶</a></h2><p>In this post, I showed you how easy it is to add comments to your blog or website without much effort using a really useful tool called utterances. Additionally, I presented a way of updating the theme used by the utterances widget so that you can correctly adjust it to a dark or light theme on your website. I hope you found that post helpful!</p></div><footer class=post-footer><nav class=paginav><a class=prev href=https://arkadiuszchmura.com/posts/how-to-dynamically-change-uistackview-axis/><span class=title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left" style="user-select:text"><line x1="19" y1="12" x2="5" y2="12" style="user-select:text"/><polyline points="12 19 5 12 12 5" style="user-select:text"/></svg>&nbsp;Prev Page</span><br><span>How to dynamically change UIStackView axis</span>
</a><a class=next href=https://arkadiuszchmura.com/posts/how-to-make-expandable-text-with-a-button-in-jetpack-compose/><span class=title>Next Page&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right" style="user-select:text"><line x1="5" y1="12" x2="19" y2="12" style="user-select:text"/><polyline points="12 5 19 12 12 19" style="user-select:text"/></svg></span><br><span>How to make expandable text with a button in Jetpack Compose</span></a></nav></footer><div class=newsletter><h2 class=header>Subscribe to my newsletter.</h2><p class=prompt>Enjoyed this post? Subscribe to be notified about my new blog posts that I consider worth sharing.</p><form action=https://tinyletter.com/cloudjr method=post target=popupwindow onsubmit='return window.open("https://tinyletter.com/cloudjr","popupwindow","scrollbars=yes,width=800,height=600"),!0'><label for=email-address class=sr-only>Email address</label>
<input id=email-address name=email type=email autocomplete=email required placeholder="Enter your email">
<button type=submit>Subscribe</button></form></div><script src=https://utteranc.es/client.js repo=ClouddJR/arkadiuszchmura.com issue-term=pathname label=comments crossorigin=anonymous async></script><script>function updateUtterancesTheme(e){const t=document.querySelector(".utterances-frame");if(t){const n={type:"set-theme",theme:e?"github-light":"github-dark"};t.contentWindow.postMessage(n,"https://utteranc.es")}}function handleMessageEvent(e){if(e.origin!=="https://utteranc.es")return;const t=!document.body.classList.contains("dark");updateUtterancesTheme(t),removeEventListener("message",handleMessageEvent)}addEventListener("message",handleMessageEvent),toggleThemeCallbacks.comments=updateUtterancesTheme</script></article></main><footer class=footer><span></span>
<span>&copy; 2023 <a href=https://arkadiuszchmura.com/>Arkadiusz Chmura</a></span></footer><script>(function(){const t=""=="1";if(t)return;let e=document.getElementById("theme-toggle");e.removeEventListener("click",toggleThemeListener),e.addEventListener("click",toggleThemeListener)})()</script><script>(function(){let e=document.getElementById("menu");e&&(e.scrollLeft=localStorage.getItem("menu-scroll-position"),e.onscroll=function(){localStorage.setItem("menu-scroll-position",e.scrollLeft)});const t=""=="1",n=""=="1";if(window.matchMedia("(prefers-reduced-motion: reduce)").matches||t||n)return;document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})})()</script><script>if(window.scrollListeners)for(const e of scrollListeners)window.removeEventListener("scroll",e);window.scrollListeners=[]</script><script src=/js/medium-zoom.min.js data-no-instant></script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="copy";function s(){t.innerText="copied!",setTimeout(()=>{t.innerText="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script>(function(){const a=""=="1";if(!a)return;if(!document.querySelector(".toc")){console.log("no toc found, ignore toc scroll");return}const r=window.scrollListeners,t=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id]"),n="active";let e=t[0];o(e).classList.add(n);const c=()=>{const s=[];for(const e of t)if(l(e)<5)s.push(e);else break;s.length>0?newActiveHeading=s[s.length-1]:newActiveHeading=t[0],e!=newActiveHeading&&(o(e).classList.remove(n),e=newActiveHeading,o(e).classList.add(n))};let s=null;const i=()=>{s!==null&&clearTimeout(s),s=setTimeout(c,50)};window.addEventListener("scroll",i,!1),r.push(i);function o(e){const t=encodeURI(e.getAttribute("id")).toLowerCase();return document.querySelector(`.toc ul li a[href="#${t}"]`)}function l(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect();return t.top}})()</script><script>mediumZoom(".entry-cover img"),mediumZoom(".post-content img:not([no-zoom])")</script></body></html>