<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>How to change system bar colors using Jetpack Compose | Arkadiusz Chmura</title><meta name=keywords content><meta name=description content="System bar colors can be changed directly with Compose, without a need to modify any XML files."><meta name=author content><link rel=canonical href=https://arkadiuszchmura.com/posts/how-to-change-system-bar-colors-in-compose/><link crossorigin=anonymous href=/assets/css/stylesheet.min.9ba27e3c8c2747e1cde460076c0ca4266a90ef93999b5f361979f681b9f778a6.css integrity="sha256-m6J+PIwnR+HN5GAHbAykJmqQ75OZm182GXn2gbn3eKY=" rel="preload stylesheet" as=style><link rel=icon href=https://arkadiuszchmura.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://arkadiuszchmura.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://arkadiuszchmura.com/favicon-32x32.png><link rel=apple-touch-icon href=https://arkadiuszchmura.com/apple-touch-icon.png><link rel=mask-icon href=https://arkadiuszchmura.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.104.2"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="How to change system bar colors using Jetpack Compose"><meta property="og:description" content="System bar colors can be changed directly with Compose, without a need to modify any XML files."><meta property="og:type" content="article"><meta property="og:url" content="https://arkadiuszchmura.com/posts/how-to-change-system-bar-colors-in-compose/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-07-20T00:00:00+00:00"><meta property="article:modified_time" content="2022-07-20T00:00:00+00:00"><meta property="og:site_name" content="Arkadiusz Chmura"><meta name=twitter:card content="summary"><meta name=twitter:title content="How to change system bar colors using Jetpack Compose"><meta name=twitter:description content="System bar colors can be changed directly with Compose, without a need to modify any XML files."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://arkadiuszchmura.com/posts/"},{"@type":"ListItem","position":2,"name":"How to change system bar colors using Jetpack Compose","item":"https://arkadiuszchmura.com/posts/how-to-change-system-bar-colors-in-compose/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"How to change system bar colors using Jetpack Compose","name":"How to change system bar colors using Jetpack Compose","description":"System bar colors can be changed directly with Compose, without a need to modify any XML files.","keywords":[],"articleBody":"Introduction In this post, I would like to show you how you can change the status bar and navigation bar colors using Compose, without having to modify any XML files.\nBefore Jetpack Compose, to specify the bar colors, we would traditionally modify the themes.xml file like this:\n","wordCount":"648","inLanguage":"en","datePublished":"2022-07-20T00:00:00Z","dateModified":"2022-07-20T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://arkadiuszchmura.com/posts/how-to-change-system-bar-colors-in-compose/"},"publisher":{"@type":"Organization","name":"Arkadiusz Chmura","logo":{"@type":"ImageObject","url":"https://arkadiuszchmura.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://arkadiuszchmura.com/ accesskey=h title="Arkadiusz Chmura (Alt + H)">Arkadiusz Chmura</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://arkadiuszchmura.com/archive title=Archive><span>Archive</span></a></li><li><a href=https://arkadiuszchmura.com/search title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://arkadiuszchmura.com/>Home</a>&nbsp;»&nbsp;<a href=https://arkadiuszchmura.com/posts/>Posts</a></div><h1 class=post-title>How to change system bar colors using Jetpack Compose</h1><div class=post-meta><span title='2022-07-20 00:00:00 +0000 UTC'>July 20, 2022</span>&nbsp;·&nbsp;4 min</div></header><div class=post-content><h2 id=introduction>Introduction<a hidden class=anchor aria-hidden=true href=#introduction>#</a></h2><p>In this post, I would like to show you how you can change the status bar and navigation bar colors using Compose, without having to modify any XML files.</p><p>Before Jetpack Compose, to specify the bar colors, we would traditionally modify the <code>themes.xml</code> file like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#ff79c6>&lt;resources&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>&lt;style</span> <span style=color:#50fa7b>name=</span><span style=color:#f1fa8c>&#34;Theme.BarColors&#34;</span> <span style=color:#50fa7b>parent=</span><span style=color:#f1fa8c>&#34;android:Theme.Material.Light.NoActionBar&#34;</span><span style=color:#ff79c6>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>&lt;item</span> <span style=color:#50fa7b>name=</span><span style=color:#f1fa8c>&#34;android:statusBarColor&#34;</span><span style=color:#ff79c6>&gt;</span>@color/purple_700<span style=color:#ff79c6>&lt;/item&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>&lt;item</span> <span style=color:#50fa7b>name=</span><span style=color:#f1fa8c>&#34;android:navigationBarColor&#34;</span><span style=color:#ff79c6>&gt;</span>@color/purple_700<span style=color:#ff79c6>&lt;/item&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>&lt;/style&gt;</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>&lt;/resources&gt;</span>
</span></span></code></pre></div><p>As you can guess, the <code>android:statusBarColor</code> and <code>android:navigationBarColor</code> attributes affect the status bar color and navigation bar color, respectively.</p><p>Additionally, we could specify <code>android:windowLightStatusBar</code> (to make the icons on the status bar dark) or <code>android:windowLightNavigationBar</code> (similarly for navigation bar). Unfortunately, the latter requires API level 27. It forces us to override this attribute in another <code>themes.xml</code> file under the <code>values-27</code> folder. It can lead to quite a messy structure when we have a lot of attributes like this. It can get even worse when we decide to support a dark theme.</p><p>Luckily, with Compose, there is another way of doing this.</p><h2 id=solution>Solution<a hidden class=anchor aria-hidden=true href=#solution>#</a></h2><p>For this example, I created a simple screen using Compose that displays centered text on a <code>Surface</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#ff79c6>class</span> <span style=color:#50fa7b>MainActivity</span> : ComponentActivity() {
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>override</span> <span style=color:#ff79c6>fun</span> <span style=color:#50fa7b>onCreate</span>(savedInstanceState: Bundle?) {
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>super</span>.onCreate(savedInstanceState)
</span></span><span style=display:flex><span>		
</span></span><span style=display:flex><span>        setContent {
</span></span><span style=display:flex><span>            BarColorsTheme {
</span></span><span style=display:flex><span>                Surface {
</span></span><span style=display:flex><span>                    Text(
</span></span><span style=display:flex><span>                        modifier = Modifier
</span></span><span style=display:flex><span>                            .fillMaxSize()
</span></span><span style=display:flex><span>                            .wrapContentHeight(),
</span></span><span style=display:flex><span>                        textAlign = TextAlign.Center,
</span></span><span style=display:flex><span>                        style = MaterialTheme.typography.h3,
</span></span><span style=display:flex><span>                        text = <span style=color:#f1fa8c>&#34;Hello Android!&#34;</span>,
</span></span><span style=display:flex><span>                    )
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>The <code>BarColorsTheme</code> (where <code>BarColors</code> is the name of the app) that wraps everything is a composable function that is created for you when you use the <code>Empty Compose Activity</code> template from the project wizard:</p><figure class=align-center><img loading=lazy src=/compose-wizard.png#center alt="Android Studio&amp;rsquo;s new project wizard"><figcaption><p>Android Studio&rsquo;s new project wizard</p></figcaption></figure><p>This is what it looks like:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#ff79c6>private</span> <span style=color:#ff79c6>val</span> DarkColorPalette = darkColors(
</span></span><span style=display:flex><span>    primary = Purple200,
</span></span><span style=display:flex><span>    primaryVariant = Purple700,
</span></span><span style=display:flex><span>    secondary = Teal200
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>private</span> <span style=color:#ff79c6>val</span> LightColorPalette = lightColors(
</span></span><span style=display:flex><span>    primary = Purple500,
</span></span><span style=display:flex><span>    primaryVariant = Purple700,
</span></span><span style=display:flex><span>    secondary = Teal200
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>@Composable
</span></span><span style=display:flex><span><span style=color:#ff79c6>fun</span> <span style=color:#50fa7b>BarColorsTheme</span>(darkTheme: Boolean = isSystemInDarkTheme(), content: @Composable () <span style=color:#ff79c6>-&gt;</span> Unit) {
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>val</span> colors = <span style=color:#ff79c6>if</span> (darkTheme) {
</span></span><span style=display:flex><span>        DarkColorPalette
</span></span><span style=display:flex><span>    } <span style=color:#ff79c6>else</span> {
</span></span><span style=display:flex><span>        LightColorPalette
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    MaterialTheme(
</span></span><span style=display:flex><span>        colors = colors,
</span></span><span style=display:flex><span>        typography = Typography,
</span></span><span style=display:flex><span>        shapes = Shapes,
</span></span><span style=display:flex><span>        content = content
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>The <code>BarColorsTheme</code> serves as a root composable that specifies the proper color palette (based on whether the dark theme is enabled), typography, and shapes for the entire hierarchy.</p><p>Because it is a root composable in our app, we can use this place to specify the system bar colors. Here is how we can do that:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span>@Composable  
</span></span><span style=display:flex><span><span style=color:#ff79c6>fun</span> <span style=color:#50fa7b>BarColorsTheme</span>(darkTheme: Boolean = isSystemInDarkTheme(), content: @Composable () <span style=color:#ff79c6>-&gt;</span> Unit) {  
</span></span><span style=display:flex><span>	<span style=color:#6272a4>// ...
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>    <span style=color:#ff79c6>val</span> view = LocalView.current  
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>if</span> (!view.isInEditMode) {  
</span></span><span style=display:flex><span>        SideEffect {  
</span></span><span style=display:flex><span>            <span style=color:#ff79c6>val</span> window = (view.context <span style=color:#ff79c6>as</span> Activity).window  
</span></span><span style=display:flex><span>            window.statusBarColor = colors.primary.toArgb()  
</span></span><span style=display:flex><span>            window.navigationBarColor = colors.primary.toArgb()  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>            WindowCompat.getInsetsController(window, view)  
</span></span><span style=display:flex><span>                .isAppearanceLightStatusBars = darkTheme  
</span></span><span style=display:flex><span>            WindowCompat.getInsetsController(window, view)  
</span></span><span style=display:flex><span>                .isAppearanceLightNavigationBars = darkTheme  
</span></span><span style=display:flex><span>        }  
</span></span><span style=display:flex><span>    }  
</span></span><span style=display:flex><span>	<span style=color:#6272a4>// ...
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>}
</span></span></code></pre></div><p>We use the <code>window</code> object associated with our activity and modify the appropriate properties - <code>statusBarColor</code> and <code>navigationBarColor</code>. We use a primary color from the current palette (in this case it&rsquo;s a shade of purple).</p><p>Additionally, we use <code>WindowCompat</code> to make the status bar and navigation bar icons light or dark, depending on the value of the <code>darkTheme</code> variable. A nice benefit of using <code>WindowCompat</code> is that we don&rsquo;t have to check the API level before executing those methods. Behind the scenes, they will have no effect on unsupported APIs.</p><p>After making those changes and running the app, we get the desired effect:</p><figure class=align-center><img loading=lazy src=/bar-colors-light.png#center alt="System bar colors changed with Compose" width=350><figcaption><p>System bar colors changed with Compose</p></figcaption></figure><p>Notice the use of <code>SideEffect</code> here. A <code>SideEffect</code> runs after <strong>every</strong> recomposition. Thanks to this, the system bar colors will be automatically updated to correct values when a user enables the dark theme, without having to reopen the app:</p><figure class=align-center><img loading=lazy src=/bar-colors-change.gif#center alt="System bar colors adapting to the current theme" width=350><figcaption><p>System bar colors adapting to the current theme</p></figcaption></figure><h2 id=summary>Summary<a hidden class=anchor aria-hidden=true href=#summary>#</a></h2><p>With Jetpack Compose, specifying system bar colors that adapt to the current theme is quite simple. All of the relevant code sits in one place. We no longer have to create different <code>themes.xml</code> files and override specific attributes.</p><p>I hope you found this post interesting. If you have any questions, feel free to reach me on <a href=https://twitter.com/ClouddJR/>Twitter</a>.</p></div><footer class=post-footer><nav class=paginav><a class=prev href=https://arkadiuszchmura.com/posts/what-is-the-difference-between-size-and-viewport-size-in-vector-drawables/><span class=title>« Prev Page</span><br><span>What is the difference between size and viewport size in vector drawables?</span></a>
<a class=next href=https://arkadiuszchmura.com/posts/how-twitter-handled-personalized-timelines-for-their-users/><span class=title>Next Page »</span><br><span>How Twitter handled personalized timelines for their users</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://arkadiuszchmura.com/>Arkadiusz Chmura</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="copy";function s(){t.innerText="copied!",setTimeout(()=>{t.innerText="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>